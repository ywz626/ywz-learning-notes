# åŸºæœ¬æ¦‚å¿µ

ç»„åˆæ¨¡å¼ï¼ˆComposite Patternï¼‰æ˜¯ä¸€ç§**ç»“æ„å‹è®¾è®¡æ¨¡å¼**ï¼Œå®ƒå…è®¸ä½ å°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„æ¥è¡¨ç¤ºâ€œéƒ¨åˆ†-æ•´ä½“â€çš„å±‚æ¬¡å…³ç³»ï¼Œè®©å®¢æˆ·ç«¯èƒ½å¤Ÿä»¥ç»Ÿä¸€çš„æ–¹å¼å¤„ç†å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡ã€‚

---

### æ ¸å¿ƒæ€æƒ³
1. **ç»Ÿä¸€å¯¹å¾…**  
   æ— è®ºæ˜¯å¶å­èŠ‚ç‚¹ï¼ˆå•ä¸ªå¯¹è±¡ï¼‰è¿˜æ˜¯å®¹å™¨èŠ‚ç‚¹ï¼ˆç»„åˆå¯¹è±¡ï¼‰ï¼Œå®¢æˆ·ç«¯éƒ½é€šè¿‡ç›¸åŒçš„æ¥å£æ“ä½œï¼Œæ— éœ€åŒºåˆ†ã€‚
2. **æ ‘å½¢ç»“æ„**  
   æ„å»ºæ ‘çŠ¶å±‚æ¬¡ç»“æ„ï¼Œå®¹å™¨èŠ‚ç‚¹å¯ä»¥åŒ…å«å¶å­èŠ‚ç‚¹æˆ–å…¶ä»–å®¹å™¨èŠ‚ç‚¹ï¼Œå½¢æˆé€’å½’åµŒå¥—ã€‚
3. **é€æ˜æ€§**  
   å¶å­èŠ‚ç‚¹å’Œå®¹å™¨èŠ‚ç‚¹å®ç°ç›¸åŒçš„æŠ½è±¡æ¥å£ï¼Œä½†å®¹å™¨èŠ‚ç‚¹é¢å¤–æä¾›ç®¡ç†å­èŠ‚ç‚¹çš„æ–¹æ³•ï¼ˆå¦‚æ·»åŠ /åˆ é™¤ï¼‰ã€‚

---

### æ ¸å¿ƒè§’è‰²
1. **Componentï¼ˆæŠ½è±¡æ„ä»¶ï¼‰**  
   - å®šä¹‰æ‰€æœ‰å¯¹è±¡çš„é€šç”¨æ¥å£ï¼ˆå¶å­èŠ‚ç‚¹å’Œå®¹å™¨èŠ‚ç‚¹ï¼‰
   - å£°æ˜æ“ä½œå­èŠ‚ç‚¹çš„æ–¹æ³•ï¼ˆå¦‚ `add()`ã€`remove()`ï¼‰å’Œä¸šåŠ¡æ–¹æ³•ï¼ˆå¦‚ `operation()`ï¼‰
   ```java
   public abstract class Component {
       public abstract void operation();
       public void add(Component c) { /* é»˜è®¤å®ç°æˆ–æŠ›å¼‚å¸¸ */ }
       public void remove(Component c) { /* é»˜è®¤å®ç°æˆ–æŠ›å¼‚å¸¸ */ }
   }
   ```

2. **Leafï¼ˆå¶å­èŠ‚ç‚¹ï¼‰**  
   - æ ‘çš„åŸºæœ¬å…ƒç´ ï¼Œ**æ²¡æœ‰å­èŠ‚ç‚¹**
   - å®ç°ä¸šåŠ¡æ–¹æ³•ï¼Œä½†ç®¡ç†å­èŠ‚ç‚¹çš„æ–¹æ³•æ— æ„ä¹‰ï¼ˆå¯ç©ºå®ç°æˆ–æŠ›å¼‚å¸¸ï¼‰
   ```java
   public class Leaf extends Component {
       @Override
       public void operation() {
           System.out.println("æ‰§è¡Œå¶å­èŠ‚ç‚¹æ“ä½œ");
       }
   }
   ```

3. **Compositeï¼ˆå®¹å™¨èŠ‚ç‚¹ï¼‰**  
   - åŒ…å«å­èŠ‚ç‚¹ï¼ˆå¯åŒ…å« Leaf æˆ–å…¶ä»– Compositeï¼‰
   - å®ç°ä¸šåŠ¡æ–¹æ³•ï¼ˆé€šå¸¸é€’å½’è°ƒç”¨å­èŠ‚ç‚¹çš„æ–¹æ³•ï¼‰
   - å®ç°å­èŠ‚ç‚¹ç®¡ç†æ–¹æ³•
   ```java
   public class Composite extends Component {
       private List<Component> children = new ArrayList<>();
       
       @Override
       public void operation() {
           for (Component child : children) {
               child.operation(); // é€’å½’è°ƒç”¨å­èŠ‚ç‚¹
           }
       }
       
       @Override
       public void add(Component c) {
           children.add(c);
       }
       
       @Override
       public void remove(Component c) {
           children.remove(c);
       }
   }
   ```

---

### ä½¿ç”¨åœºæ™¯
1. **æ ‘å½¢ç»“æ„ç³»ç»Ÿ**  
   å¦‚æ–‡ä»¶ç³»ç»Ÿï¼ˆç›®å½•åŒ…å«æ–‡ä»¶æˆ–å­ç›®å½•ï¼‰ã€ç»„ç»‡æ¶æ„ï¼ˆéƒ¨é—¨åŒ…å«å‘˜å·¥æˆ–å­éƒ¨é—¨ï¼‰ã€‚
2. **ç»Ÿä¸€å¤„ç†éœ€æ±‚**  
   å½“éœ€è¦å¿½ç•¥å•ä¸ªå¯¹è±¡ä¸ç»„åˆå¯¹è±¡çš„å·®å¼‚æ—¶ï¼ˆå¦‚ GUI ä¸­çš„çª—å£å’ŒæŒ‰é’®ç»„ï¼‰ã€‚
3. **é€’å½’æ“ä½œ**  
   éœ€è¦é€’å½’å¤„ç†æ•´ä¸ªæ ‘ç»“æ„çš„åœºæ™¯ï¼ˆå¦‚è®¡ç®—ç›®å½•æ€»å¤§å°ï¼‰ã€‚

---

### ä»£ç ç¤ºä¾‹ï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰
```java
// æŠ½è±¡æ„ä»¶
abstract class FileSystemComponent {
    protected String name;
    public FileSystemComponent(String name) { this.name = name; }
    public abstract void display(int depth);
    public void add(FileSystemComponent c) {}
    public void remove(FileSystemComponent c) {}
}

// å¶å­èŠ‚ç‚¹ï¼šæ–‡ä»¶
class File extends FileSystemComponent {
    public File(String name) { super(name); }
    @Override
    public void display(int depth) {
        System.out.println("-".repeat(depth) + "ğŸ“„ " + name);
    }
}

// å®¹å™¨èŠ‚ç‚¹ï¼šç›®å½•
class Directory extends FileSystemComponent {
    private List<FileSystemComponent> children = new ArrayList<>();
    public Directory(String name) { super(name); }
    
    @Override
    public void display(int depth) {
        System.out.println("-".repeat(depth) + "ğŸ“ " + name);
        for (FileSystemComponent child : children) {
            child.display(depth + 2); // é€’å½’æ˜¾ç¤ºå­èŠ‚ç‚¹
        }
    }
    
    @Override
    public void add(FileSystemComponent c) {
        children.add(c);
    }
    
    @Override
    public void remove(FileSystemComponent c) {
        children.remove(c);
    }
}

// å®¢æˆ·ç«¯
public class Client {
    public static void main(String[] args) {
        // æ„å»ºæ ‘å½¢ç»“æ„
        Directory root = new Directory("æ ¹ç›®å½•");
        
        Directory docs = new Directory("æ–‡æ¡£");
        docs.add(new File("ç®€å†.pdf"));
        docs.add(new File("æŠ¥å‘Š.docx"));
        
        Directory images = new Directory("å›¾ç‰‡");
        images.add(new File("photo1.jpg"));
        
        root.add(docs);
        root.add(images);
        root.add(new File("README.txt"));
        
        // ç»Ÿä¸€æ“ä½œæ•´ä¸ªç»“æ„
        root.display(0);
    }
}
```

**è¾“å‡ºç»“æœ**ï¼š
```
ğŸ“ æ ¹ç›®å½•
  ğŸ“ æ–‡æ¡£
    ğŸ“„ ç®€å†.pdf
    ğŸ“„ æŠ¥å‘Š.docx
  ğŸ“ å›¾ç‰‡
    ğŸ“„ photo1.jpg
  ğŸ“„ README.txt
```

---

### ä¼˜ç¼ºç‚¹
**âœ… ä¼˜ç‚¹**ï¼š
1. å®¢æˆ·ç«¯ä»£ç ç®€æ´ï¼Œæ— éœ€åŒºåˆ†å¶å­èŠ‚ç‚¹å’Œå®¹å™¨èŠ‚ç‚¹ã€‚
2. ç¬¦åˆå¼€é—­åŸåˆ™ï¼Œæ–°å¢èŠ‚ç‚¹ç±»å‹æ— éœ€ä¿®æ”¹å·²æœ‰ä»£ç ã€‚
3. å¤©ç„¶æ”¯æŒé€’å½’ç»“æ„ï¼Œæ–¹ä¾¿å¤„ç†å¤æ‚å±‚æ¬¡ã€‚

**âŒ ç¼ºç‚¹**ï¼š
1. å¶å­èŠ‚ç‚¹å’Œå®¹å™¨èŠ‚ç‚¹çš„è¡Œä¸ºå·®å¼‚å¯èƒ½å¯¼è‡´æ¥å£å†—ä½™ï¼ˆå¶å­èŠ‚ç‚¹éœ€å®ç°æ— æ„ä¹‰çš„æ–¹æ³•ï¼‰ã€‚
2. è¿‡åº¦é€šç”¨åŒ–çš„è®¾è®¡å¯èƒ½ä½¿ç³»ç»Ÿéš¾ä»¥ç†è§£ã€‚

---

### é€æ˜å¼ vs å®‰å…¨å¼
| **ç±»å‹**   | **ç‰¹ç‚¹**                            | **ç¼ºç‚¹**                             |
| ---------- | ----------------------------------- | ------------------------------------ |
| **é€æ˜å¼** | æ‰€æœ‰æ–¹æ³•å®šä¹‰åœ¨ Component ä¸­         | å¶å­èŠ‚ç‚¹éœ€å®ç°æ— æ„ä¹‰çš„å­èŠ‚ç‚¹ç®¡ç†æ–¹æ³• |
| **å®‰å…¨å¼** | å­èŠ‚ç‚¹ç®¡ç†æ–¹æ³•ä»…åœ¨ Composite ä¸­å®šä¹‰ | å®¢æˆ·ç«¯éœ€åŒºåˆ† Leaf å’Œ Composite       |

---

### ç°å®åº”ç”¨
- **Java AWT/Swing**ï¼š`Container`ï¼ˆå®¹å™¨ï¼‰å’Œ `Component`ï¼ˆç»„ä»¶ï¼‰çš„ç»§æ‰¿ä½“ç³»ã€‚
- **XML/JSON è§£æ**ï¼šèŠ‚ç‚¹ï¼ˆå…ƒç´ ï¼‰å’Œå­èŠ‚ç‚¹ï¼ˆå±æ€§/åµŒå¥—å…ƒç´ ï¼‰çš„ç»Ÿä¸€å¤„ç†ã€‚
- **èœå•ç³»ç»Ÿ**ï¼šèœå•é¡¹ï¼ˆå¶å­ï¼‰å’Œå­èœå•ï¼ˆå®¹å™¨ï¼‰ã€‚

ç»„åˆæ¨¡å¼é€šè¿‡æ ‘å½¢ç»“æ„å’Œç»Ÿä¸€æ¥å£ï¼Œå®ç°äº†å¤æ‚å¯¹è±¡å±‚æ¬¡çš„é«˜æ•ˆç®¡ç†ï¼Œæ˜¯å¤„ç†é€’å½’ç»“æ„çš„ç»å…¸è§£å†³æ–¹æ¡ˆã€‚





